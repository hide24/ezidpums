<?xml version="1.0" encoding="UTF-8"?>
<AttributeFilterPolicyGroup id="ShibbolethFilterPolicy"
        xmlns="urn:mace:shibboleth:2.0:afp"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="urn:mace:shibboleth:2.0:afp http://shibboleth.net/schema/idp/shibboleth-afp.xsd">

<% @service_providers.each do |service_provider| -%>
    <AttributeFilterPolicy id="Policyfor<%= service_provider.name %>">
        <PolicyRequirementRule xsi:type="Requester" value="<%= service_provider.entity_id %>" />

<% service_provider.idp_attributes.each do |idp_attribute| -%>
        <AttributeRule attributeID="<%= idp_attribute.name %>">
            <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
<% end %>
    </AttributeFilterPolicy>
<% end %>
</AttributeFilterPolicyGroup>
